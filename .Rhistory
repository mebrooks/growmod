library(growmod)#
#
true=c("(Intercept)"=1, age=0,  "I(age^2)"=0, size=.6, "size:age"=0, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
#
sg=simobs(true, nind=1000, ntime=40)#
#
m1=growmod(~1, ~1, data=sg, REcohort=FALSE)#
summary(m1)
summary(m1$sdr,"fixed")
true=c("(Intercept)"=1, age=0,  "I(age^2)"=0, size=.6, "size:age"=0, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
sg=simobs(true, nind=100, ntime=20)#
m1=growmod(~1, ~1, data=sg, REcohort=FALSE)#
summary(m1)
library(growmod)#
true=c("(Intercept)"=1, age=0,  "I(age^2)"=0, size=.6, "size:age"=0, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
sg=simobs(true, nind=100, ntime=20)#
m1=growmod(~1, ~1, data=sg, REcohort=FALSE)#
summary(m1)
mod
cf
cf=summary(mod$sdr, "fixed")#
	nf=rownames(cf)#
	take0=grep("beta", nf)#
	take0=c(take0, grep("eta", nf))
take0
nf
cf=summary(mod$sdr, "fixed")#
	nf=rownames(cf)#
	take0=grep("beta", nf)#
	take0=unique(c(take0, grep("eta", nf)))#
	if(size0) {#
		take0=c(take0, grep("theta", nf))#
		nf[nf=="theta"]=paste0("size0 model ",mod$Bnames)#
	}#
	nf[nf=="beta"]=mod$Xnames#
	nf[nf=="eta"]=paste0("size:",mod$Mnames)#
	nf[nf=="size:(Intercept)"]="size"#
	rownames(cf)=nf#
	cf2=cf[take0, ]
cr=summary(mod$sdr, "report")#
	nr=rownames(cr)#
	take=grep("growth_sd",nr)#
	take=c(take, grep("sigma_obs",nr))#
	take=c(take, grep("sigma_proc",nr))#
	take=c(take, grep("indiv_cor",nr))#
	if(CV) { take = c(take, grep("CV",nr))}#
	if(size0) { take = c(take, grep("size0_sd",nr))}#
	cr2=cr[take, ]#
	c2=as.data.frame(rbind(cf2,cr2))#
  	c2$var=rownames(c2)#
  	colnames(c2)[1]="est"#
	colnames(c2)[2]="se"#
	c3=transform(c2, "t value"=est/se)
c3
extract_coefs=function(mod, CV=FALSE, size0=FALSE)#
{#
#takes  results of growmod() and returns a data frame of est, sd, z.value, and names of coefficients#
	cf=summary(mod$sdr, "fixed")#
	nf=rownames(cf)#
	take0=grep("beta", nf)#
	take0=unique(c(take0, grep("eta", nf)))#
	if(size0) {#
		take0=c(take0, grep("theta", nf))#
		nf[nf=="theta"]=paste0("size0 model ",mod$Bnames)#
	}#
	nf[nf=="beta"]=mod$Xnames#
	nf[nf=="eta"]=paste0("size:",mod$Mnames)#
	nf[nf=="size:(Intercept)"]="size"#
	rownames(cf)=nf#
	cf2=cf[take0, ]#
#
	cr=summary(mod$sdr, "report")#
	nr=rownames(cr)#
	take=grep("growth_sd",nr)#
	take=c(take, grep("sigma_obs",nr))#
	take=c(take, grep("sigma_proc",nr))#
	take=c(take, grep("indiv_cor",nr))#
	if(CV) { take = c(take, grep("CV",nr))}#
	if(size0) { take = c(take, grep("size0_sd",nr))}#
	cr2=cr[take, ]#
	c2=as.data.frame(rbind(cf2,cr2))#
  	c2$var=rownames(c2)#
  	colnames(c2)[1]="est"#
	colnames(c2)[2]="se"#
	c3=transform(c2, "t value"=est/se)#
	return(c3)#
}
extract_coefs(m1)
mod=m1
cf=summary(mod$sdr, "fixed")#
	nf=rownames(cf)
which(nf=="beta")
sg2=sg[-5,]
sg2=sg[-50,]
m2=growmod(~1, ~1, data=sg2, REcohort=FALSE)
library(growmod)#
true=c("(Intercept)"=1, age=0,  "I(age^2)"=0, size=.6, "size:age"=0, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
sg=simobs(true, nind=1000, ntime=20)#
m1=growmod(~1, ~1, data=sg, REcohort=FALSE)#
summary(m1)
1/20
library(growmod)#
true=c("(Intercept)"=1, age=0,  "I(age^2)"=0, size=.6, "size:age"=0, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
sg=simobs(true, nind=1000, ntime=20)#
m1=growmod(~1, ~1, data=sg)#
summary(m1)
set.seed(111)
sg=simobs(true, nind=1000, ntime=20)#
m1=growmod(~1, ~1, data=sg)
library(growmod)#
true=c("(Intercept)"=1, age=0,  "I(age^2)"=0, size=.6, "size:age"=0, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
set.seed(111)#
sg=simobs(true, nind=2000, ntime=20)#
m1=growmod(~1, ~1, data=sg)#
summary(m1)
set.seed(1111)#
sg=simobs(true, nind=2000, ntime=20)#
m1=growmod(~1, ~1, data=sg)
summary(m1)
sg=simobs(true, nind=000, ntime=20)#
m1=growmod(~1, ~1, data=sg)#
summary(m1)
growmod(~1, ~1, data=sg, estobserr=FALSE)
residuals(m1, sg)
?residuals.growmod
?summary.growmod
sg$res=residuals(m1, sg)
with(sg, plot(age, res))
str(sg)
res=residuals(m1, sg)
head(res)
head(sg)
library(growmod)#
true=c("(Intercept)"=1, age=0,  "I(age^2)"=0, size=.6, "size:age"=0, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
set.seed(1111)#
sg=simobs(true, nind=1000, ntime=20)#
m1=growmod(~1, ~1, data=sg)#
summary(m1)#
sg$res=residuals(m1, sg)
residuals(m1)
str(m1)
? residuals.growmod
residuals.growmod(m1)
library(bbmle)
?AICtab
AIC
AICtab
ICtab
library(growmod)#
true=c("(Intercept)"=1, age=0,  "I(age^2)"=0, size=.6, "size:age"=0, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
set.seed(1111)#
sg=simobs(true, nind=1000, ntime=20)#
m1=growmod(~1, ~1, data=sg)#
summary(m1)
