sg=simobs(true, nind=000, ntime=20)#
m1=growmod(~1, ~1, data=sg)#
summary(m1)
growmod(~1, ~1, data=sg, estobserr=FALSE)
residuals(m1, sg)
?residuals.growmod
?summary.growmod
sg$res=residuals(m1, sg)
with(sg, plot(age, res))
str(sg)
res=residuals(m1, sg)
head(res)
head(sg)
library(growmod)#
true=c("(Intercept)"=1, age=0,  "I(age^2)"=0, size=.6, "size:age"=0, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
set.seed(1111)#
sg=simobs(true, nind=1000, ntime=20)#
m1=growmod(~1, ~1, data=sg)#
summary(m1)#
sg$res=residuals(m1, sg)
residuals(m1)
str(m1)
? residuals.growmod
residuals.growmod(m1)
library(bbmle)
?AICtab
AIC
AICtab
ICtab
library(growmod)#
true=c("(Intercept)"=1, age=0,  "I(age^2)"=0, size=.6, "size:age"=0, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
set.seed(1111)#
sg=simobs(true, nind=1000, ntime=20)#
m1=growmod(~1, ~1, data=sg)#
summary(m1)
library(growmod)#
library(plyr)#
library(lme4)#
true=c("(Intercept)"=1, age=10,  "I(age^2)"=0, size=.6, "size:age"=-1, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
set.seed(1111)#
sim=simobs(true, nind=1000, ntime=20)#
m1=growmod(~age, ~age, data=sim)#
summary(m1)
true=c("(Intercept)"=1, age=-1,  "I(age^2)"=0, size=.6, "size:age"=1, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
set.seed(1111)#
sim=simobs(true, nind=1000, ntime=20)#
m1=growmod(~age, ~age, data=sim)
true=c("(Intercept)"=1, age=2,  "I(age^2)"=0, size=.6, "size:age"=-.5, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
set.seed(1111)#
sim=simobs(true, nind=1000, ntime=20)#
m1=growmod(~age, ~age, data=sim)
true=c("(Intercept)"=1, age=.5,  "I(age^2)"=0, size=.6, "size:age"=-.5, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
set.seed(1111)#
sim=simobs(true, nind=1000, ntime=20)#
m1=growmod(~age, ~age, data=sim)
library(growmod)#
library(plyr)#
library(lme4)#
true=c("(Intercept)"=1, age=.5,  "I(age^2)"=0, prevsize=.6, "prevsize:age"=-.5, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
set.seed(1111)#
sim=simobs(true, nind=1000, ntime=20)#
m1=growmod(~age, ~age, data=sim)#
#
sim2=ddply(organize_data(sim, sigma_obs = .01)$Ldat$Predictors, ~ID, mutate,#
	sizenext= size[match(age, age-1)],#
	sizeprev= size[match(age, age+1)]#
)#
#
m2=lmer(size~age+age*sizeprev+(1|ID)+(1|t), sim2)#
summary(m1)#
summary(m2)
head(sim)
true=c("(Intercept)"=1, age=.05,  "I(age^2)"=0, prevsize=.6, "prevsize:age"=-.05, sigma_proc=.01, time_growth_sd=.1, indiv_growth_sd=.1, indiv_age_growth_sd=0, indiv_cor=0, size0_mu=2.5, size0_sd=1)#
set.seed(1111)#
sim=simobs(true, nind=1000, ntime=20)
summary(sim)
m1=growmod(~age, ~age, data=sim)
summary(m1)
m2=lmer(size~age+age*sizeprev+(1|ID)+(1|t), sim2)
sim2=ddply(organize_data(sim, sigma_obs = .01)$Ldat$Predictors, ~ID, mutate,#
	sizenext= size[match(age, age-1)],#
	sizeprev= size[match(age, age+1)]#
)#
#
m2=lmer(size~age+age*sizeprev+(1|ID)+(1|t), sim2)
summary(m1)#
summary(m2)
141/30*50
extract_coef(m1)
sim2=ddply(organize_data(sim, sigma_obs = .01)$Ldat$Predictors, ~ID, mutate,#
	prevsize= size[match(age, age+1)]#
)#
#
m2=lmer(size~age+age* prevsize +(1|ID)+(1|t), sim2)#
summary(m1)#
summary(m2)
extract_coefs(m1)
fixef(m2)
extract_coefs(m1)$est
fixef(m2)-extract_coefs(m1)$est[1:length(fixef(m2))]
library(growmod)#
library(ggplot2)#
library(splines)#
#growth parameters#
a0 = -1#hypothetical age when L=0#
k = 0.25#
k_sd= k*.05#
Linf = 100#
Linf_sd=Linf*.05#
#
#data set size parameters#
nind=300#
maxage=30#
dat=expand.grid(ID=1:nind, age=0:maxage)#
dat$t0=sample(1:10, nind, replace=TRUE)#
Linf_ID=rnorm(nind, Linf, sd=Linf_sd)#
k_ID=rnorm(nind, k, sd=k_sd)#
dat=transform(dat, #
		t=t0+age,#
		Linf=Linf_ID[ID],#
		k=k_ID[ID])#
dat=transform(dat, size=log( Linf*(1 - exp(-k*(age - a0)))))#
obs=dat#
#
ggplot(dat, aes(x=age, y=size))+theme_bw()+geom_point()
library(MuMIn)
dredge(lmm0)
?dredge
?geom_abline
?growmod
vignette("growmod")
?match
